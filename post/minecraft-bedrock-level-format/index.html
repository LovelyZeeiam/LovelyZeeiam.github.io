<html>
<head>
    <meta charset="utf-8"/>
<meta name="description" content=""/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>

<title>Minecraft基岩版存档格式简介（未完成） | Xueli的小博客</title>

<link rel="shortcut icon" href="https://lovelyzeeiam.github.io/favicon.ico?v=1600008302637">

<link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://lovelyzeeiam.github.io/styles/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.min.css">

<script src="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets/highlight.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.15.10/languages/dockerfile.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.15.10/languages/dart.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/moment@2.27.0/moment.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/js/bootstrap.min.js"></script>
<!-- DEMO JS -->
<!--<script src="media/scripts/index.js"></script>-->



    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.css">
</head>
<body>
<div class="main gt-bg-theme-color-first">
    <nav class="navbar navbar-expand-lg">
    <div class="navbar-brand">
        <img class="user-avatar" src="/images/avatar.png" alt="头像">
        <div class="site-name gt-c-content-color-first">
            Xueli的小博客
        </div>
    </div>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <i class="fas fa-bars gt-c-content-color-first" style="font-size: 18px"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <div class="navbar-nav mr-auto" style="text-align: center">
            
                <div class="nav-item">
                    
                        <a href="/" class="menu gt-a-link">
                            首页
                        </a>
                    
                </div>
            
                <div class="nav-item">
                    
                        <a href="/archives" class="menu gt-a-link">
                            归档
                        </a>
                    
                </div>
            
                <div class="nav-item">
                    
                        <a href="/tags" class="menu gt-a-link">
                            标签
                        </a>
                    
                </div>
            
                <div class="nav-item">
                    
                        <a href="/post/about" class="menu gt-a-link">
                            关于
                        </a>
                    
                </div>
            
        </div>
        <div style="text-align: center">
            <form id="gridea-search-form" style="position: relative" data-update="1600008302637" action="/search/index.html">
                <input class="search-input" autocomplete="off" spellcheck="false" name="q" placeholder="搜索文章" />
                <i class="fas fa-search gt-c-content-color-first" style="position: absolute; top: 9px; left: 10px;"></i>
            </form>
        </div>
    </div>
</nav>

    <div class="post-container">
        <div class="post-detail gt-bg-theme-color-second">
            <article class="gt-post-content">
                <h2 class="post-title">
                    Minecraft基岩版存档格式简介（未完成）
                </h2>
                <div class="post-info">
                    <time class="post-time gt-c-content-color-first">
                        · 2020-08-31 ·
                    </time>
                    
                </div>
                <div class="post-content">
                    <p><font size="1">花絮： 今天的bgm是什么呢？</p>
<p>啊 是sans.（<br>
</font></p>
<h1 id="目录">目录</h1>
<p>[TOC]</p>
<h1 id="写在前面">写在前面</h1>
<p><del>人在家中，刚下床，谢邀。</del>本专栏由&quot;基本&quot;不会编程的up🐖书写，许多专业术语知识还欠缺，可能会有错误，还请大佬们见谅。</p>
<p>许多时候程序yuan并不会那么bt，许多在编程中用到数据的命名肯定都和英语有一部分关系，mc的level.dat就是一个例子。</p>
<figure data-type="image" tabindex="1"><img src="https://i0.hdslb.com/bfs/article/4adb9255ada5b97061e610b682b8636764fe50ed.png" alt="img" loading="lazy"></figure>
<h1 id="存档全局信息"><strong>存档全局信息</strong></h1>
<p>网上关于修改level.dat的教程其实害挺多的，沃这里就一笔带过一下Awawawa~</p>
<p>level.dat是以<strong>未经压缩的NBT格式</strong>存储的（划重点，java版的level.dat是经过GZIP格式压缩的NBT格式）。NBT全名Named Binary  Tag，学过编程的小伙伴可以理解为一个Json数据的结构，没有学过的可以理解成一个数学中的函数——即给出一串文字，有且仅有唯一一个对象与之对应（之类的东西）。</p>
<p>但是捏  <sub>(￣▽￣)</sub>*，这个文件不是一开始就是nbt数据的开头。这个文件的一开始有留出四个字节。这四个字节会被游戏视为介个level.dat文件的版本号，后续如果要对这个文件的架构进行大的修改就可以通过版本号来判断这个文件是否该升级惹。接下来才是NBT的正文数据。</p>
<p>用NBT修改器打开这个文件，可以根据英文和游戏中敲命令的经历判断出每一个参数的名称对应的是游戏中的什么参数或功能（许多常用的修改都可以通过这个判断）。</p>
<p>存档里面的levelname.txt，这个应该是mojang为了玩家方便查找存档从而创建的一个记录存档名称的文件。但是如果只修改这个文件是达不到修改存档在游戏中显示的名称的。在游戏中修改存档的名称时，游戏会同时改变level.dat内的某个数据和levelname.txt文件；但是仅修改了levelname.txt文件，在游戏中是看不到修改后的存档名称的哦。</p>
<p>world_icon.jpeg是存档图标，长宽分别是400和225.</p>
<h1 id="存档资源包信息"><strong>存档资源包信息</strong></h1>
<p>加入过资源包的存档，在该存档的文件夹会出现world_resource_packs.json和world_resource_pack_history.json以及resource_packs文件夹。加入过行为包的存档，会出现world_behavior_packs.json和world_behavior_pack_history.json以及behavior_packs文件夹。</p>
<p>上面提到出现的文件夹是存储这个资源包或行为包的目录，在这个目录里面会有加载过的资源包或行为包，以文件夹的形式放在这个目录下（不是压缩文件哦）。</p>
<p>world_****_packs.json的文件是以Json格式存储。这个Json文件存储了当前这个存档正在使用的包，里面每个包信息的pack_id和version会与包中menifest.json文件中header属性中的pack_id和version对应。</p>
<p>world_****_pack_history.json文件里面存储了至今这个存档使用了那些包。里面每个包的信息会与包中menifest.json文件中header属性中的pack_id和version对应。can_be_redownloaded参数是用来判断这个包是否是商店内下载的包，当这个属性是true的时候，游戏将会去自身的包下载缓存目录寻找这个包，在Windows 10上这个目录是:  &quot;C:\Users\宁的用户名\AppData\Local\Packages\Microsoft.MinecraftUWP_8wekyb3d8bbwe\LocalState\&quot; 但是里面几乎所有的内容都被加密辽，，，。这个目录里面还有一个persona文件夹，应该是存储了在游戏内自定义皮肤的里面的信息。skin_packs文件夹里面存储的是皮肤包。手机root不了所以看不到在哪里，有兴趣的小伙伴可以去手机的根目录找找（大家平时打开手机自身的文件管理器打开的不是根目录**!!!**沃记得的ES文件管理器和MT管理器都可以看到手机根目录的文件)</p>
<p>值得注意的是，开发者可以将自己要测试的包放在com.mojang文件夹下面的development_****_packs文件夹下面。放在这里的包在游戏中导入时，是不会被复制到存档自身的****_pack文件夹里面的哦。所以，如果是边开发边测试一个包，可以直接在development_****_packs文件夹里面创建一个文件夹作为存储这个包的地方，导出这个包时直接将这个文件夹里面的所有文件压缩就可以啦。</p>
<h1 id="nbt格式概述">NBT格式概述</h1>
<p>【本节涉及到小字节序和大字节序，然后up不会讲,,,大家可以去看https://zhuanlan.zhihu.com/p/21388517的&quot;2.2 字节序&quot;一节】</p>
<p>Minecraft在java版和基岩版的数据存储都或多或少的使用了NBT格式。在这里简单的说明一下NBT格式是个什么东西。首先得先说明一下，这种格式是可以嵌入的，不仅仅是在一个文件里面，还可以存在于一个文件的一部分。上面提到过，NBT全名Named Binary  Tag，学过编程的小伙伴可以理解为一个Json数据的结构，没有学过的可以理解成一个数学中的函数——即给出一串文字，有且仅有唯一一个对象与之对应（之类的东西）。在这里我们会来探讨这些数据是如何存储的。（notch提供的nbt.txt说明文档国内好像上不去，能得到这个文件的好心人可以把原文或者网盘地址放在评论区嘛，蟹蟹！~，地址：web.archive.org/web/20110723210920/http://www.minecraft.net/docs/NBT.txt）</p>
<p>既然叫Named Binary Tag，咱们肯定先得看看一个Tag怎么存储。一个Tag的第一个字节代表这个Tag的类型，第二个字节和第三个字节在一起以大字节序组成一个数字，是这个Tag名字的长度。接下来跟着的就是这个Tag的内容，在百度百科叫做辅助信息。</p>
<p><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/d2e81a8aff8ca3015224f1c5fcdb0bdf204292ed.png" alt="img" loading="lazy"><br>
来自百度百科 - NBT （二进制命名标签）</p>
<p>在NBT中，游戏一般会拿一个长度为3的数组存储一个坐标或一个长方体的长宽高。如果是存储坐标的话，这个数组的第一个元素就代表x坐标，第二个元素代表y坐标，第三个元素代表z坐标；如果是存储一个矩形的大小的话，那么这个数组的三个元素分别代表这个矩形的长宽高。这个在下面就不再赘述了。</p>
<p>还有一点就是在游戏里面，观测到存在NBT格式的地方，都会由一个Compound Tag包裹着。也就是说，游戏内存在的NBT标签，最外面一层都应该一个或多个是Compound Tag。这一点下面可能会提到，也可能不会【因为这是沃在写村庄那一节的时候写嗲】，所以的话，就，大家都懂，对吧？【听不见听不见】</p>
<h1 id="存档其它信息"><strong>存档其它信息</strong></h1>
<p>其它的信息包括地形信息，方块内部特有的信息，实体信息等等（或许概括全了）都<strong>存在&quot;db&quot;文件夹里面</strong>。这个文件夹里面存储的是一个LevelDB数据库（以下简称数据库）。与NBT类似，也是给出一个值，会返回另外一个唯一的值（程序员: 不就是key-value数据库嘛）。</p>
<p>（偷个懒 技术玩家可以通过直接写代码的方式来访问这个数据库 其ta的玩家捏可以通过MCC ToolChest打开这个存档 不过后者可能可见的信息要少一些）</p>
<p>既然给出一个值(key)就返回另外一个唯一的值(value)，那么我们肯定得先从给出的这个值开始入手。咱们从简单的开始。</p>
<h3 id="计分板">计分板</h3>
<p>计分板肯定得算比较简单的。直接向这个数据库里面传入&quot;scoreboard&quot;中每个字母的ascii码组成的数组就可以（Java: &quot;scoreboard&quot;.getBytes() 后 遗 症)，获取到一个未经压缩的小字节序NBT数据。这个数据中会存储着5个数据:</p>
<p><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/1feac2b904272561f7b536bf597f8978c5f40672.png" alt="img" loading="lazy">五个数据哦~</p>
<h3 id="玩家">玩家</h3>
<p>游戏中，玩家肯定也是不可少的一部分（废话）。修改玩家的信息也足够简单，不过获取一个玩家的信息是一件难事。目前还未发现比较轻便的查找对应玩家信息的方法。</p>
<p>在数据库中，得到本地玩家的玩家信息要传的参数为&quot;~local_player&quot;；</p>
<p>得到真正的玩家信息要传的参数为&quot;player_********-****-****-****-************&quot;；</p>
<p>当然也会有一种玩家信息是带server的，这种应该是基岩版官方服务器的存档内存储的玩家信息，要传的参数为&quot;player_server_********-****-****-****-************&quot;（下划线和横杠杠不要看错了沃）。（星号组成一个uuid 大概是游戏随机分配的）</p>
<p>（老爹：还有一件事：要传的是这些文字的ASCII码组成的数组!）</p>
<p>三种情况得到的都是一个小字节序的NBT数据。第一种情况和第三种情况得到的NBT数据大致上都应该相同（常用的参数应该都拥有）。第二种情况可能会得到只含三个参数的NBT标签：</p>
<p>​    MsaId和SelfSignedId： 这两个标签似乎都有可能与ta所在标签的名称相同，目前未找到用途；</p>
<p>​    ServerId： 可以直接将这个数据传进数据库，会得到上面提到的第三种情况的数据.</p>
<p>得到的玩家的NBT数据可以直接根据其名称来判断这个属性控制的是游戏中的什么功能（学英文的重要性（ε=┏(゜ロ゜;)┛）） 其它看不懂的，大部分都有可能是一修改就出问题 或是无实际功能或修改价值 抑或是没修炼够/doge：</p>
<figure data-type="image" tabindex="2"><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/b3d378d421926dd8ab4bc85223a1fa9dde00e10e.png" alt="img" loading="lazy"></figure>
<p>（当然可能也可以通过修改这个来达到使玩家pregnant的臆想效果（</p>
<h3 id="地图">地图</h3>
<p>像素画大师们最钟情（可能）的东西。在数据库中，要想找到一个指定的地图并非容易。得到一个地图数据需要传的参数的格式: &quot;map_&quot;+一串数字。如果单纯看这串十进制的数据，是比较难发现规律的。我们将其变成16进制康康：</p>
<figure data-type="image" tabindex="3"><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/a5e271909e7e54bb652b642a1108a8548ca6cdf6.png" alt="img" loading="lazy"></figure>
<p>不难发现（），这串数字的前四位与FF FF FF FF代表的数字相差加上1，即为在创建这个地图的时候进游戏的次数。不过这串数字后四个字节就非常非常神奇，观测是离关游戏的时间越近，这四个字节在大端序下代表的数字就会越小。</p>
<p>并且有时候总会有5个地图的id是连续的。呐是因为呀，当玩家在游戏中创建了一个地图后，游戏内部会新增5个这样连续的id代表5个不同的地图数据。这5个不同的数据代表了该地图的5个级别，就算玩家没有主动去合成其它四个不同级别的地图。</p>
<p>【似乎只能通过玩家手里拿的物品来找到指定的地图了】</p>
<p>我们通过键得到的仍然是一个小字节序的未经压缩的NBT数据。里面可以进行大肆（雾）修改的就是colors数据。这个colors记录了地图128*128图片大小的数据，先从左到右存储图片的第一行像素，依次向图片下方存储。其中每四个字节分别对应r,g,b,a的值，代表一个像素。</p>
<p>地图里面还存储了decorations数据，类型是Compound Tag，这里存储的是地图上面的有些装饰，这个数据里面还存储了2个Compound  Tag叫data和key。key里面存储的是这个装饰的世界位置和类型，data里面存储了这个装饰的方向(rot)，类型(type)和相对于地图的位置（？x, y)。</p>
<p>修改完成地图后，不要忘了把dimension调成-1噢~ 调成-1后，游戏内就对这个地图的修改撒手了。</p>
<p><strong>还有一些其ta的</strong></p>
<p>可以在这里找到: https://minecraft.gamepedia.co/Bedrock_Edition_level_format#Other_keys</p>
<p>（是英文的 Awa）</p>
<h3 id="结构">结构</h3>
<p>想要找到一个结构是非常简单的事，只需要在宁的结构名称前面加上“structuretemplate_”就可以找到了。但是解读其是需要地形存储的基础的，所以咱们就放在地形存储之后再讲这个。</p>
<h1 id="村庄">村庄</h1>
<p>目前已知的找到村庄的方法就是通过村民的实体NBT找到”DwellingUniqueID“的对应的值，这个值是一个字符串，我们在这个字符串前面加入”VILLAGE_&quot;，后面加上&quot;_&quot;，然后再加上四个不同的全大写的单词，就可以得到村庄的四种类型的信息：加上”INFO“可以得到这个村庄的全局信息，”PLAYERS“可以得到每个玩家的声望值，”POI“可以得到村民的工作站点，”DWELLERS“可以得到这个村庄内的所有与村庄有关的生物。</p>
<h3 id="村庄信息">村庄信息</h3>
<p>得到的数据是一个小字节序的未经压缩的NBT。其中包括这些值：【沃对村庄机制几乎不了解 这个剩下的就留给大家填叭~】</p>
<table>
<thead>
<tr>
<th style="text-align:center">键</th>
<th style="text-align:center">类型</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Version</td>
<td style="text-align:center">Byte</td>
<td style="text-align:center">本村庄说明的版本</td>
</tr>
<tr>
<td style="text-align:center">Initialized</td>
<td style="text-align:center">Byte</td>
<td style="text-align:center">该村庄是否被初始化? (观测到应该一直是1)</td>
</tr>
<tr>
<td style="text-align:center">BDTime</td>
<td style="text-align:center">Long</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">GDTime</td>
<td style="text-align:center">Long</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">MTick</td>
<td style="text-align:center">Long</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">PDTick</td>
<td style="text-align:center">Long</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">Tick</td>
<td style="text-align:center">Long</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">VHTime</td>
<td style="text-align:center">Long</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">RX0</td>
<td style="text-align:center">Integer</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">RX1</td>
<td style="text-align:center">Integer</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">RY0</td>
<td style="text-align:center">Integer</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">RY1</td>
<td style="text-align:center">Integer</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">RZ0</td>
<td style="text-align:center">Integer</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">RZ1</td>
<td style="text-align:center">Integer</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">X0, Y0, Z0, X1, Y1, Z1</td>
<td style="text-align:center">Integer</td>
<td style="text-align:center">X0, Y0, Z0形成一个坐标，X1, Y1, Z1形成另一个坐标，分别代表这个村庄的范围即一个长方体的体对角线上的两个顶点。</td>
</tr>
</tbody>
</table>
<h3 id="工作站点">工作站点</h3>
<p>获取到的是一个Compound Tag，即复合标签。在这个复合标签里面有且仅有一个标签，叫&quot;POI&quot;，是个长度不确定的列表。在这里面的每一项都是一个Compound Tag，分别对应村庄中每一个村民的信息。每个村民对应的Compound Tag中会有一个Long类型的整数，代表的是这个村民的实体ID；还会有一个列表，名字叫&quot;instances&quot;，目前观测到的这个列表的长度是3。在这个列表里面存储的是村民的三个状态对应的地点。这个列表会有三个元素。游戏在读取时，（猜测）会循环这三个元素（即这三个Compound Tag，如果发现这个Compound Tag里面的Skip值为1，则跳过这个Compound Tag，否则就会读取这个Compound Tag的其它内容。傻子的这个Compound Tag里面的Skip值为1。一个这样子的Compound Tag的包含这些东西：【沃对村庄机制几乎不了解 这个剩下的就留给大家填叭~】</p>
<table border=1>
    <tr>
    	<th><center>键</center></th>
       	<th><center>类型</center></th>
        	<th><center>说明</center></th>
    </tr>
    <tr>
    	<td><center>Skip</center></td>
        	<td style="color:#66CCFF;"><center>Boolean</center></td>
        	<td><center>游戏在读取这个标签时，是否会跳过这个标签不去理会其它内容。</center></td>
    </tr>
    <tr>
    	<td><center>Type</center></td>
        	<td style="color:#66CCFF;"><center>Integer</center></td>
        	<td><center>该工作站点的类型。0代表床，1代表钟，2代表职业对应的方块。</center></td>
    </tr>
    <tr>
    	<td><center>Name</center></td>
        <td style="color:#66CCFF;"><center>String</center></td>
        <td>
            <center>该工作站点对应的村民的名字，当上面的Type是2时，这个值会随着下表村民的职业变动，否则就为"villager"：
                <table border=1>
					<tr>
						<th><center>职业</center></th>
                        <th><center>对应Name的值</center></th>
                        <th><center>原版游戏中工作声音在资源包内标识</center></th>
					</tr>
                    <tr>
						<td style="color:#00FFCC;"><center>盔甲匠</center></td>
                        <td style="color:#39c5bb;"><center>armorer</center></td>
                		<td style="color:#993366;"><center>block.blastfurnace.fire_crackle</center></td>
					</tr>
            		<tr>
						<td style="color:#00FFCC;"><center>制图师</center></td>
                        <td style="color:#39c5bb;"><center>cartographer</center></td>
						<td style="color:#993366;"><center>block.cartography_table.use</center></td>
					</tr>
					<tr>
						<td style="color:#00FFCC;"><center>图书管理员</center></td>
                        <td style="color:#39c5bb;"><center>librarian</center></td>
						<td style="color:#993366;"><center>item.book.put</center></td>
					</tr>
					<tr>
						<td style="color:#00FFCC;"><center>牧师</center></td>
                        <td style="color:#39c5bb;"><center>cleric</center></td>
						<td style="color:#993366;"><center>potion.brewed</center></td>
					</tr>
					<tr>
						<td style="color:#00FFCC;"><center>皮匠</center></td>
                        <td style="color:#39c5bb;"><center>leatherworker</center></td>
						<td style="color:#993366;"><center>bucket.fill.water</center></td>
					</tr>
					<tr>
						<td style="color:#00FFCC;"><center>武器匠</center></td>
                        <td style="color:#39c5bb;"><center>weaponsmith</center></td>
						<td style="color:#993366;"><center>block.grindstone.use</center></td>
					</tr>
					<tr>
						<td style="color:#00FFCC;"><center>屠夫</center></td>
                        <td style="color:#39c5bb;"><center>butcher</center></td>
						<td style="color:#993366;"><center>block.smoker.smoke</center></td>
					</tr>
					<tr>
						<td style="color:#00FFCC;"><center>工具匠</center></td>
                        <td style="color:#39c5bb;"><center>toolsmith</center></td>
						<td style="color:#993366;"><center>block.smithing_table.use</center></td>
					</tr>
					<tr>
						<td style="color:#00FFCC;"><center>石匠</center></td>
                        <td style="color:#39c5bb;"><center>mason</center></td>
						<td style="color:#993366;"><center>block.stonecutter.use</center></td>
					</tr>
					<tr>
						<td style="color:#00FFCC;"><center>制箭师</center></td>
                        <td style="color:#39c5bb;"><center>fletcher</center></td>
						<td style="color:#993366;"><center>block.fletching_table.use</center></td>
					</tr>
					<tr>
						<td style="color:#00FFCC;"><center>牧羊人</center></td>
                        <td style="color:#39c5bb;"><center>shepherd</center></td>
						<td style="color:#993366;"><center>block.loom.use</center></td>
					</tr>
                    <tr>
						<td style="color:#00FFCC;"><center>农民</center></td>
                        <td style="color:#39c5bb;"><center>farmer</center></td>
						<td style="color:#993366;"><center>block.composter.fill</center></td>
					</tr>
                    <tr>
						<td style="color:#00FFCC;"><center>农民</center></td>
                        <td style="color:#39c5bb;"><center>farmer</center></td>
						<td style="color:#993366;"><center>block.composter.fill</center></td>
					</tr>
                    <tr>
						<td style="color:#00FFCC;"><center>渔夫</center></td>
                        <td style="color:#39c5bb;"><center>fisherman</center></td>
						<td style="color:#993366;"><center>block.barrel.open</center></td>
					</tr>
                </table>
            </center></td>
    </tr>
    <tr>
    	<td><center>X, Y, Z</center></td>
        <td style="color:#66CCFF;"><center>Integer</center></td>
        <td><center>该工作站点的坐标</center></td>
    </tr>
	<tr>
    	<td><center>SoundEvent</center></td>
        <td style="color:#66CCFF;"><center>String</center></td>
        <td><center>该职业对应的工作的声音在资源包里面的定义，游戏原版默认值写在上表了。游戏默认只有在Type=2时这个值才会随着职业而变化，其ta时候都是"undifined"</center></td>
    </tr>
    <tr>
    	<td><center>UseAABB</center></td>
        <td style="color:#66CCFF;"><center>Byte</center></td>
        <td><center></center></td>
    </tr>
    <tr>
    	<td><center>Radius</center></td>
        <td style="color:#66CCFF;"><center>Float</center></td>
        <td><center></center></td>
    </tr>
    <tr>
    	<td><center>Capacity</center></td>
        <td style="color:#66CCFF;"><center>Long</center></td>
        <td><center></center></td>
    </tr>
    <tr>
    	<td><center>Weight</center></td>
        <td style="color:#66CCFF;"><center>Long</center></td>
        <td><center></center></td>
    </tr>
</table>
<p>例：一个只有一个村民的测试村庄的留念（bushi</p>
<figure data-type="image" tabindex="4"><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/image-20200913164012377.png" alt="image-20200913164012377" loading="lazy"></figure>
<h3 id="村庄生态">村庄生态</h3>
<p>获取到的村庄生态是一个Compound Tag，在这里面会有一个列表叫“Dwellers”，列表总是存放着四个Compound Tag。每个Compound Tag里面都有一个叫Actors的列表，这个列表记录的对象类型是Compound Tag。在下面会以“第n个列表”的方式来提及这个“Actors”列表，大家就将其认为是“Dwellers”列表中的第n个Compound Tag里面的&quot;Actors&quot;的列表就好。</p>
<p>第一个列表里面的每个Compound Tag都记录了一个村民的信息，其中包括三个参数：ID，类型为Long，代表村民的实体ID（UniqueID）；last_worked，类型为Long，代表上一次工作时距离开启世界多少个游戏刻；TS类型也为Long，但是并不清楚这个数值是干什么的。</p>
<p>第二个列表里面的每个Compound Tag都记录了一个村民的信息，其中包括两个参数：ID，类型为Long，代表村民的实体ID（UniqueID）；TS类型也为Long，但是并不清楚这个数值是干什么的。</p>
<p>第三个列表里面的每个Compound Tag按理来说也应该记录一个什么东西的，但是（笑哭😂）实在想不到有什么了，，，</p>
<p>第四个列表里面的每个Compound Tag都记录了一只猫的信息，其中包括两个参数：ID，类型为Long，代表猫的实体ID（UniqueID）；TS类型也为Long，但是并不清楚这个数值是干什么的。</p>
<h3 id="玩家声望">玩家声望</h3>
<p>得到并不是直接的玩家声望，而是一个Compound Tag，这个父标签里面有且仅有一个Tag，类型是List，里面存储的是Compound Tag，每个Compound Tag都有两个Tag：ID，类型为Long，是玩家ID（UniqueID）；S，类型为Int，是玩家的声望值，即：</p>
<figure data-type="image" tabindex="5"><img src="C:/Users/22598/AppData/Roaming/Typora/typora-user-images/image-20200913205524952.png" alt="image-20200913205524952" loading="lazy"></figure>
<h1 id="世界维度信息">世界维度信息</h1>
<p>【TODO】</p>
<h1 id="地形存储">地形存储</h1>
<p><strong>【本节内容可能会有不对的地方 也请大佬们在评论底下修正 非常感谢！】</strong></p>
<p>终于到我们的重头戏了——游戏的地形存储。<del>今天小编就来带大家看看。</del></p>
<p>首先还是我们的惯例，灵魂疑问：该怎么得到区块的信息呢？真的很简单，人人都可以学得会：首先将这个区块的x坐标以小字节序变成四个字节（即一个int类型）然后将这个区块的z坐标也以小字节序变成四个字节紧随其后，如果这个区块不是主世界区块那就再将其维度对应的id以小字节序还是变成四个字节跟在后面（1是地狱，2是末地），然后后面跟上一个特定的数字以一个字节存储的字节。这个特定的数字可以是下面的任意一个，取决于要申请的数据的类型：【下面有一类数据，只传这个特定的数字是拿不到滴，下面会有解释】</p>
<figure data-type="image" tabindex="6"><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/77932686035b7324f5ba68f63e5db2352359bb6f.png" alt="img" loading="lazy"></figure>
<p>【TODO: 发现也可以传入51，得到的好像是隔一段时间就要刷新的东西比如说流动的水】</p>
<p>例： 如果想要申请x坐标是114514，z坐标是1919180的区块的高度图（臭味图（逃）和生物群系:</p>
<figure data-type="image" tabindex="7"><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/d43f4f78deb235cffff4e47725952c59ba7402c8.gif" alt="img" loading="lazy"></figure>
<h3 id="高度图和生物群系">高度图和生物群系</h3>
<p>​    申请得到的高度图和生物群系中，前512个字节存储的是高度图。高度图存储了俯视这个区块得到的平面图中，每一格存储一个short类型（一个占两个字节的整数）代表这一格最高的方块处在的y坐标。紧接着是生物群系，以同样的方式，但是是以每一格一个byte类型存储生物群系id。</p>
<p><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/381545dcdfdacb447b46b2b1a65825984c7e65f8.png" alt="img" loading="lazy"><br>
左图:mcc tool chest pe截图 横坐标是x 纵坐标是z   右图:从数据库中取出的数据在十六进制编辑器中的模样</p>
<h3 id="方块实体数据">方块实体数据</h3>
<p>申请得到的方块实体数据是一个小字节序的NBT数据。</p>
<figure data-type="image" tabindex="8"><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/46b06817a8eb2f0db31b1c982eb1306f0d174a4c.png" alt="img" loading="lazy"></figure>
<p>有些方块为了每一个游戏刻都要刷新，所以将其归结到方块实体里面；还有一些功能方块，存储的数据比较多，所以就存在了这里，具体为什么要放在下面的地形数据再说啦~</p>
<p>由于未在minecraft维基上面找到每个方块实体存储的信息（抑或是我没找到），于是沃自己整理了一下：</p>
<p>（以下内容按照CC BY-NC-SA 3.0协议分享）</p>
<ol>
<li>
<p>旗帜</p>
<ul>
<li>
<p>Base: (Integer) 旗帜的背景颜色</p>
<figure data-type="image" tabindex="9"><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/image-20200831160640985.png" alt="image-20200831160640985" loading="lazy"></figure>
</li>
<li>
<p>id: (String) 应该都是banner</p>
</li>
<li>
<p>x, y, z: (Integer) 旗帜所占用的方块所在坐标 <strong>【这个参数是每个方块实体数据都有的哦 下面就不写啦】</strong></p>
</li>
<li>
<p>isMovable: (Byte) 是否能被活塞推动，默认是1，即能推动。0是不能被推动。</p>
</li>
<li>
<p>Type: (Integer) 还未发现其用处</p>
</li>
</ul>
</li>
<li>
<p>蜂巢，蜂箱 （沃用summon指令创建多只蜜蜂然后游戏就卡死辽？？）</p>
<ul>
<li>
<p>id: (String) 应该都是Beehive</p>
</li>
<li>
<p>isMovable: (Byte) 是否能被活塞推动，默认是1，即能推动。0是不能被推动。</p>
</li>
<li>
<p>Occupants: (List) 指的是这个beehive里面存储了什么东西。里面存储的都是Json对象。每个Json对象包括:</p>
<ul>
<li>
<p>ActorIdentifier: (String) 当这个值为&quot;minecraft:bee&lt;&gt;&quot;时，代表这是一只可爱的小蜜蜂~ （也没发现可以存什么其它的值呀/xk 不过保持严谨就对(个鬼)）</p>
</li>
<li>
<p>TicksLeftToStay: (Integer) 表示从此刻开始多少个游戏刻之后蜜蜂就会跑粗来</p>
</li>
<li>
<p>SaveData: (Compound) 当&quot;ActorIdentifier&quot;是”minecraft:bee&lt;&gt;“时，这里直接存储了这个蜜蜂的实体NBT，如下图:</p>
<figure data-type="image" tabindex="10"><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/QQ%E5%9B%BE%E7%89%8720200831171900.png" alt="So_Long~" loading="lazy"></figure>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>牌子</p>
<ul>
<li>id: (String) 一直都是&quot;Sign&quot;的说~</li>
<li>isMovable: (Byte) 是否能被活塞推动，默认是1，即能推动。0是不能被推动。</li>
<li>Text: (String) 牌子上面写的字 换行使用&quot;\n&quot;</li>
<li>TextOwner: (String) 这个值似乎跟编辑这个牌子的玩家有关，但是好像又在玩家的nbt里面找不到与这段文字相同的内容,,,（或许是由于今天是开学前一天沃写的比较急就没有认真找的缘故吧）</li>
</ul>
</li>
<li>
<p>箱子，陷阱箱，漏斗，投掷器，发射器，潜影盒</p>
<ul>
<li>id: (String) 一直都是&quot;Chest&quot;的</li>
<li>isMovable: (Byte) 是否能被活塞推动，默认是1，即能推动。0是不能被推动。</li>
<li>Items: (List) 存储了箱子里面的东西。这跟玩家物品栏的存储类似，就是只有当这一格有物品时，游戏才会将其存储到存档里面。当没有存放物品的时候，游戏会将这个存储成一个长度为0的空列表。当向里面存放物品的时候，游戏回家原封不动地将物品的NBT复制到这里面来，并加上一个Byte类型的Slot标签。</li>
<li>（仅漏斗） TransferCooldown: (Integer) 猜测是当漏斗传输完一个物品，这个值就会变成漏斗传输物品的冷却tick数，每个tick对这个数递减，当这个数变成0之后就传输下一个物品。还未得到证实（因为太难证实了啊啊啊）</li>
<li>（仅箱子，陷阱箱，潜影盒） Findable: (Byte) 似乎没什么用的亚子，默认是0</li>
<li>（仅潜影盒） facing: (Byte) 潜影盒的朝向，如下表:
<table>
<thead>
<tr>
<th style="text-align:center">方向</th>
<th style="text-align:center">上</th>
<th style="text-align:center">下</th>
<th style="text-align:center">东</th>
<th style="text-align:center">西</th>
<th style="text-align:center">南</th>
<th style="text-align:center">北</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">&quot;facing&quot;值</td>
<td style="text-align:center">1</td>
<td style="text-align:center">0</td>
<td style="text-align:center">5</td>
<td style="text-align:center">4</td>
<td style="text-align:center">3</td>
<td style="text-align:center">2</td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>例： 一个箱子的NBT:</p>
<figure data-type="image" tabindex="11"><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/image-202008311830.PNG" alt="一个箱子的方块实体NBT" loading="lazy"></figure>
</li>
<li>
<p>篝火，灵魂篝火</p>
<ul>
<li>id: (String) &quot;Campfire&quot;没得洗</li>
<li>isMovable: (Byte) 是否能被活塞推动，默认是1，即能推动。0是不能被推动。</li>
<li>Items1, Items2, Items3, Items4: (Compound) 是篝火的四个槽位。当这上面没有物品时，游戏就不会存储这个Tag。并且与箱子不同的是，这里并不会增加Slot标签。玩家向篝火上面沿着逆时针放物品。</li>
<li>ItemTime1, ItemTime2, ItemTime3, ItemTime4: (Integer) 对应的篝火的四个槽位的已经进行烧烤（）的游戏tick数。</li>
</ul>
<p>例： 一个篝火的方块实体NBT:</p>
<figure data-type="image" tabindex="12"><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/image-202008311848.PNG" alt="一个篝火的方块实体NBT" loading="lazy"></figure>
</li>
<li>
<p>酿造台</p>
<ul>
<li>
<p>id: (String) &quot;BrewingStand&quot;没得洗</p>
</li>
<li>
<p>isMovable: (Byte) 是否能被活塞推动，默认是1，即能推动。0是不能被推动。</p>
</li>
<li>
<p>CookTime: (Short) 烹饪时间（才怪）是离炼完这次药还有多少的游戏tick。</p>
</li>
<li>
<p>FuelAmount: (Short) 燃料的数量。装入一个烈焰粉，会让这个数变成20。炼一次药，会让这个数减去一。当这个数为0时，就代表燃料耗尽，能不能再炼药了。</p>
</li>
<li>
<p>FuelTotal: (Short) 观测一直是20，大概是开发者忘了删掉这个吧。</p>
</li>
<li>
<p>Items: (List) 跟箱子的Items存储类似，但是在里面炼出来的药水会多出来一个标签：<br>
<img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/image-202008311930.PNG" alt="我们中，出了一个叛徒" loading="lazy"></p>
<p>酿造台中每个槽所代表的位置放在下图:</p>
<figure data-type="image" tabindex="13"><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/image-202008311917.PNG" alt="酿造台的槽位位置" loading="lazy"></figure>
<p>例： 一个正在酿造的酿造台的方块实体NBT:</p>
</li>
</ul>
<figure data-type="image" tabindex="14"><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/image-202008311924.PNG" alt="一个正在酿造的酿造台的方块实体NBT" loading="lazy"></figure>
</li>
<li>
<p>熔炉，烟熏炉，高炉</p>
<ul>
<li>id: (String)
<table>
<thead>
<tr>
<th style="text-align:center">熔炉</th>
<th style="text-align:center">烟熏炉</th>
<th style="text-align:center">高炉</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Furnace</td>
<td style="text-align:center">Smoker</td>
<td style="text-align:center">BlastFurnace</td>
</tr>
</tbody>
</table>
</li>
<li>isMovable: (Byte) 是否能被活塞推动，默认是1，即能推动。0是不能被推动。</li>
<li>CookTime: (Short) 当前物品离烧完成还需多少游戏tick</li>
<li>BurnTime: (Short) 当前燃料还可以燃烧多少游戏tick</li>
<li>StoredXPInt: (Integer) 炉子里面存储的经验数量</li>
<li>Items: (List) 跟箱子的作法一样。每个槽位对应的Slot数量如下:<br>
<img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/image-202008311944.PNG" alt="梅开二度" loading="lazy"></li>
</ul>
<p>例： 一个熔炉的方块实体NBT:</p>
</li>
</ol>
<figure data-type="image" tabindex="15"><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/image-202008311948.PNG" alt="一个熔炉的方块实体NBT" loading="lazy"></figure>
<ol start="8">
<li>
<p>讲台</p>
<ul>
<li>id: (String) &quot;Lectern”跑不掉</li>
<li>isMovable: (Byte) 是否能被活塞推动，默认是1，即能推动。0是不能被推动。</li>
<li>page: (Integer) 目前该讲台展示的书本所在的页数。本标签仅在讲台有书的时候才会被保存。</li>
<li>totalPages: (Integer) 该讲台展示的书本总页数本标签仅在讲台有书的时候才会被保存。</li>
<li>hasBook: (Byte) 这个讲台是否有书在上面，有就是1。本标签仅在讲台有书的时候才会被保存。</li>
<li>book: (Compound) 这里保存了展示的书的物品NBT。</li>
</ul>
<p>例： 一个放置了书的讲台（上）和一个没有放书的讲台（下）:</p>
</li>
</ol>
<figure data-type="image" tabindex="16"><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/image-202008311959.PNG" alt="一个放置了书的讲台（上）和一个没有放书的讲台（下）" loading="lazy"></figure>
<ol start="9">
<li>
<p>信标</p>
<ul>
<li>id: (String) &quot;Beacon”</li>
<li>isMovable: (Byte) 是否能被活塞推动，默认是1，即能推动。0是不能被推动。</li>
<li>primary: (Integer) 信标的第一级效果应用的药水效果id【跟java版的作用一样~省了我好多实验的时间】</li>
<li>Secondary: (Integer) 信标的第二级效果应用的药水效果id</li>
</ul>
<p>注：如果&quot;primary&quot;和&quot;Secondary&quot;的值相同，那么效果就会变成二级的。</p>
<p>附赠一张基岩版的药水效果对应id表~:</p>
</li>
</ol>
<p>​     <img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/image-202008312013.PNG" alt="基岩版的药水效果对应id表" loading="lazy"></p>
<p>​	许许多多的信标，猜猜ta们的对应效果叭~:</p>
<figure data-type="image" tabindex="17"><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/image-202008312018.PNG" alt="许许多多的信标" loading="lazy"></figure>
<ol start="10">
<li>
<p>刷怪笼</p>
<ul>
<li>id: (String) &quot;MobSpawner”</li>
<li>isMovable: (Byte) 是否能被活塞推动，默认是1，即能推动。0是不能被推动。</li>
<li>EntityIdentifier: (String) 该刷怪笼生成的怪物id, 例: &quot;minecraft:polar_bear&quot;。当该刷怪笼是空时，这个值为空。</li>
<li>MinSpawnDelay, MaxSpawnDelay: (Short) 该刷怪笼的最小和最大的刷怪间隔</li>
<li>RequiredPlayerRange: (Short) 当玩家在刷怪笼几格内时，刷怪笼才会尝试去生成生物（即冒烟（</li>
<li>SpawnRange: (Short) 【自己讲不清楚...找维基, 然后改一改】刷怪笼可以随机生成实体的范围。生成区域为正方体，含刷怪笼所在的方块。生物将会随机生成在以刷怪笼的 X、Z 坐标和以刷怪笼底部的Y坐标为中心的2格高的区域。</li>
<li>MaxNearbyEntities: (Short) 刷怪笼尝试生成生物时，刷怪笼周围的最大实体数量。</li>
<li>SpawnCount: (Short) 刷怪笼每次尝试生成生物的尝试数量（因为在游戏体验中，有时候刷怪笼并不会每次都会生成4个怪物）</li>
<li>Delay: (Short) 下一次生成生物的时间离现在有多少游戏tick。当玩家距离刷怪笼的长度满足刷怪笼的生成条件且刷怪笼内部有刷怪蛋时，这个值才会刷新。刷新这个值，即取在最小刷怪间隔和最大刷怪间隔之间取一个随机数。</li>
<li>DisplayEntityHeight, DisplayEntityScale, DisplayEntityWidth: (Float) 需要证实： 游戏每次尝试生成生物时，会以DisplayEntityWidth为长和宽，DisplayEntityHeight为高的矩形去测试某个地方是否会生成生物。</li>
</ul>
<p>例: 一个被修改过的空的刷怪箱:</p>
<figure data-type="image" tabindex="18"><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/image-202008312103.PNG" alt="整篇文章怎么洋溢着一股臭味呢" loading="lazy"></figure>
</li>
<li>
<p>音符盒</p>
<ul>
<li>id: (String) &quot;Music” 第一个与对应的方块的英文名字不一样的id!</li>
<li>isMovable: (Byte) 是否能被活塞推动，默认是1，即能推动。0是不能被推动。</li>
<li>note: (Byte) 该音符的音高。通俗来讲就是玩家敲击了几次音符盒。如图:</li>
</ul>
<figure data-type="image" tabindex="19"><img src="https://static.wikia.nocookie.net/minecraft_zh_gamepedia/images/b/bd/Noteblock_reference.png/revision/latest/scale-to-width-down/720?cb=20190129093637" alt="Noteblock reference.png" loading="lazy"></figure>
<p>例：一个被敲击了一次的音符盒的方块实体NBT标签:</p>
</li>
</ol>
<figure data-type="image" tabindex="20"><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/image-202008312055.PNG" alt="一个被敲击了一次的音符盒的方块实体NBT标签" loading="lazy"></figure>
<ol start="12">
<li>
<p>唱片机</p>
<ul>
<li>id: (String) &quot;Jukebox”</li>
<li>isMovable: (Byte) 是否能被活塞推动，默认是1，即能推动。0是不能被推动。</li>
<li>RecordItem: (Compound) 是该唱片内部存储的唱片物品的NBT。当这个唱片机里面没有唱片时，则没有这一项。</li>
</ul>
<p>例：上方是内部存有游戏里没有的唱片的唱片机，下方是没有唱片的:</p>
<figure data-type="image" tabindex="21"><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/image-202008312101.PNG" alt="上方是内部存有游戏里没有的唱片的唱片机，下方是没有唱片的" loading="lazy"></figure>
</li>
</ol>
<blockquote>
<p><code>【雪莉：现在时间是8月31号晚上9点18分，似乎...算了，抓紧吧，以后来作业了又...】</code></p>
</blockquote>
<ol start="13">
<li>
<p>伸出的活塞臂</p>
<ul>
<li>id: (String) &quot;PistonArm”</li>
<li>Sticky: (Byte) 活塞臂是否是黏糊糊的（粘性活塞）</li>
</ul>
<p>研究这个比较困难，因为活塞伸出的时间就只有那么长，想要踩点对我来说还是很困难的。于是下面就直接展示自己的研究过程吧。</p>
<p>​	首先我摆放了四个活塞，一个不伸出，一个伸出来，还有一个伸到一半，最后一个缩回来一半(怎么说起来那么奇怪呢)。并对比两者中有何变化。以下是有变化的项(在我的测试时):</p>
<p>​	【呜呜呜┭┮﹏┭┮获得这些数据花了我好久因为我是手残QwQ 所以那个按钮之类的...Awq】</p>
<p>​	【部分数据是猜测 不过大概率肯定是对的 【啊...手残党...】】</p>
<p>​	【我的测试是将粘性活塞放在[ 4, 8, 11 ]的地方，将[ 4, 8, 10 ]的方块来回推，下表从左到右展示了这个过程】</p>
</li>
</ol>
<table align="center">
            <tr>
                <td><b>项的名称</b></td>
                <td><b>活塞臂未伸出时的值</b></td>
                <td colspan="2"><b>活塞臂正在伸出时的值</b></td>
                <td><b>活塞臂伸出时的值</b></td>
                <td colspan="2"><b>活塞臂正在缩回时的值</b></td>
            </tr>
            <tr>
                <td>isMovable</td>
                <td>1</td>
                <td>1</td>
                <td>1</td>
                <td>0</td>
                <td>0</td>
                <td>0</td>
            </tr>
            <tr>
                <td>LastProgress</td>
                <td>0</td>
                <td>0</td>
                <td>0.5</td>
                <td>1</td>
                <td>1</td>
                <td>0.5</td>
            </tr>
            <tr>
                <td>Progress</td>
                <td>0</td>
                <td>0.5</td>
                <td>1</td>
                <td>1</td>
                <td>0.5</td>
                <td>0</td>
            </tr>
            <tr>
                <td>State</td>
                <td>0</td>
                <td>1</td>
                <td>1</td>
                <td>2</td>
                <td>3</td>
                <td>3</td>
            </tr>
            <tr>
                <td>NewState</td>
                <td>0</td>
                <td>1</td>
                <td>1</td>
                <td>2</td>
                <td>3</td>
                <td>3</td>
            </tr>
            <tr>
                <td>AttachedBlocks</td>
                <td>[]</td>
                <td>[ 4, 8, 10 ]</td>
                <td>[ 4, 8, 10 ]</td>
                <td>[]</td>
                <td>[ 4, 8, 9 ]</td>
                <td>[ 4, 8, 9 ]</td>
            </tr>
</table>
<blockquote>
<p><code>【22点21了...】</code></p>
</blockquote>
<p>​			其实还有一个项，&quot;BreakBlocks&quot;。猜测是由于我的测试一直都是推方块，所以这个值一直都没用到【要那样测试的话...我已经在233层高楼上面准备把空气当床了】。估计这个BreakBlocks如果使用到了的话，相同的情况对应的跟上面的movingBlocks的值是相同的。</p>
<p>​			研究发现，当粘性的活塞臂正在伸出时，其AttachedBlocks会的值为其活塞臂粘着的方块还未被推动时的原坐标；当粘性的活塞臂正在缩回时，其AttachedBlocks会的值为其活塞臂粘着的方块还未被拉回时的原坐标。</p>
<p>​			由于测试太过繁琐，所以我们来直接推测一下如果不是粘性活塞而是普通的活塞，那么这些值会怎么变化。推测：其它值都随着上面的走，但AttachedBlocks只在活塞推动了一个方块时才会有值。</p>
<p>​			【幸亏测试的是粘性活塞呀，不然...233层高楼我来了】</p>
<p>​			排除了这些项之后，,,,，好像就没有其ta项了嘻嘻(●'◡'●) 直接进入下一个。</p>
<ol start="14">
<li>
<p>正在被活塞移动的方块：当上面活塞臂的state是1或3时才会出现这个类型的实体方块。</p>
<ul>
<li>id: (String) &quot;MovingBlock”</li>
<li>isMovable: (Byte) 是否能被活塞推动，默认是1，即能推动。0是不能被推动。</li>
<li>movingBlock: (Compound) 记录了这个movingBlock的方块NBT</li>
<li>movingBlockExtra: (Compound) 记录了一个方块NBT，在自己的实验中好像一直是air的方块nbt。TODO: 尝试用活塞去拉史莱姆方块粘着的方块看看这个值。</li>
</ul>
</li>
</ol>
<p>​			既然跟活塞运动有关【不要想歪真的没有那种意思】，我们就使用跟研究活塞一样的列表思路。下表记录的仍然是有变化的量。<br>
​			【部分数据是猜测 不过大概率肯定是对的 【啊...手残党... *2】】<br>
​			【我的测试是将粘性活塞放在[ 4, 8, 11 ]的地方，将[ 4, 8, 10 ]的红石块来回推，下表从左到右展示了这个过程】<br>
​			【什么？宁认为我又会去做一遍实验? Oh no~ 我在做实验时发现了这个MovingBlock，在做上面的实验的时候顺便也记下来惹~~~~】</p>
<blockquote>
<p><code>【第二天晚上】</code></p>
</blockquote>
<table>
	<tr>
        <td><b>项的名称</b></td>
		<td><b>活塞臂未伸出时的值</b></td>
		<td colspan="2"><b>活塞臂正在伸出时的值</b></td>
		<td><b>活塞臂伸出时的值</b></td>
		<td colspan="2"><b>活塞臂正在缩回时的值</b></td>
	</tr>
    <tr>
                <td>State (这个是复制的上面一个表 方便记录)</td>
                <td>0</td>
                <td>1</td>
                <td>1</td>
                <td>2</td>
                <td>3</td>
                <td>3</td>
            </tr>
    <tr>
		<td>pistonPosX, pistonPosY, pistonPosZ </td>
        <td>[]</td>
        <td>[ 4, 8, 11 ]</td>
        <td>[ 4, 8, 11 ]</td>
        <td>[]</td>
        <td>[ 4, 8, 11 ]</td>
        <td>[ 4, 8, 11 ]</td>
	</tr>
	<tr>
		<td>x, y, z</td>
        <td>[]</td>
        <td>[ 4, 8, 9 ]</td>
        <td>[ 4, 8, 9 ]</td>
        <td>[]</td>
        <td>[ 4, 8, 10 ]</td>
        <td>[ 4, 8, 10 ]</td>
	</tr>
</table>
<p>​			于是可以得出普遍规律: 当出现这个实体方块NBT时，pistonPosX, pistonPosY, pistonPosZ指向的坐标总是推这个方块的活塞；当活塞正在推ta时，x, y, z指向的坐标是这个实体方块将被推到的坐标，反之，当活塞正在拉ta时，x，y，z指向的是这个实体方块将被拉回到的坐标。</p>
<p>​			为了猜测movingBlockExtra的用途，我打算继续做一个实验:</p>
<figure data-type="image" tabindex="22"><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/Minecraft_2020_9_1_23_30_04.png" alt="又一个实验" loading="lazy"></figure>
<p>​			当我用史莱姆方块拉着一个方块让活塞臂进行伸缩运动时，红石块出现的MovingBlock方块实体NBT内，pistonPosX, pistonPosY, pistonPosZ仍然是推拉史莱姆方块的活塞的坐标。movingBlockExtra仍然是空气的方块NBT。</p>
<blockquote>
<p><code>【屑博主仍然在学校写完了几乎所有作业的第三个晚上】</code></p>
</blockquote>
<ol start="15">
<li>
<p>附魔台</p>
<ul>
<li>id: (String) &quot;EnchantTable”</li>
<li>isMovable: (Byte) 是否能被活塞推动，默认是1，即能推动。0是不能被推动。</li>
<li>rott: (Float) 似乎跟漂浮的书有关，不清楚规律。</li>
</ul>
</li>
<li>
<p>末地传送门</p>
<ul>
<li>id: (String) &quot;EndPortal”</li>
<li>isMovable: (Byte) 是否能被活塞推动，默认是1，即能推动。0是不能被推动。</li>
</ul>
</li>
<li>
<p>末影箱</p>
<ul>
<li>id: (String) &quot;EnderChest”</li>
<li>isMovable: (Byte) 是否能被活塞推动，默认是1，即能推动。0是不能被推动。</li>
<li>items: (List) 猜测应该是末影箱里面存放的东西，但是观测一直是长度为0的空列表</li>
</ul>
</li>
<li>
<p>头颅</p>
<ul>
<li>id: (String) &quot;Skull”</li>
<li>isMovable: (Byte) 是否能被活塞推动，默认是1，即能推动。0是不能被推动。</li>
<li>SkullType: (Byte) 头颅类型，如下表:</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">SkullType</th>
<th style="text-align:center">类型</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0</td>
<td style="text-align:center">骷髅</td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">凋零骷髅</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">僵尸</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">玩家</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">Creeper?</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">末影龙</td>
</tr>
</tbody>
</table>
<ul>
<li>MouthMoving: (Byte) 嘴巴是否动，应该只对末影龙头有效</li>
<li>MouthTickCount: (Integer) 单位是游戏tick，跟嘴巴动的动画有关。</li>
<li>Rotation: (Float) 头颅的摆放方向</li>
</ul>
</li>
<li>
<p>命令方块</p>
<ul>
<li>id: (String) &quot;CommandBlock”</li>
<li>isMovable: (Byte) 是否能被活塞推动，默认是1，即能推动。0是不能被推动。</li>
<li>ExecuteOnFirstTick: (Byte) 指定循环型命令方块是否在激活后立即执行其命令。如果为0，则从激活时起延迟延迟时间后再执行；为1则会在激活时立即执行命令。</li>
<li>auto: (Byte) 当这个值为1时，该命令方块选项界面的“红石”将会是“始终活动&quot;选项。即【引用Wiki: 命令方块甚至在没有红石信号时也会保持为开启状态 （连锁型命令方块将在感应后执行命令， 循环型命令方块将在每一游戏刻执行一次命令（每秒20次），脉冲型命令方块在设置完毕后将立即激活，且此后将无法再次执行）】</li>
<li>TickDelay: (Integer) 即命令方块界面中的“已选择的延迟” 【附上维基上面对于“已选择的延迟”的解释：对于脉冲型命令方块和连锁型命令方块，“已选择的延迟”的值即在被激活或触发后，执行命令之前延迟的游戏刻。对于循环型命令方块，“已选择的延迟”的值即其循环执行指令中间间隔的的游戏刻。注意：对于脉冲型命令方块和循环型命令方块，延迟设置为0和1的效果相同，游戏将把0视为1】</li>
<li>Command: (String) 该命令方块的命令</li>
<li>conditionMet: (Byte) 1或0（是/否）- 指示条件命令块在上次激活时是否满足其条件。如果不是条件命令块，则为1【维基是这样说，但是仍然发现了不是条件命令块且也为0的情况】</li>
<li>LastExecution: (Long) 这个命令方块最后被成功执行的游戏刻</li>
<li>LastOutputParams: (List) 观察这里是长度为3的列表（即这个列表里面有三项）</li>
<li>LastOutput: (String) 这里是指向语言文件的一个索引。程序yuan为了方便做国际化，会将游戏中出现的文字都变成一段特定的字符和符号组合，在游戏的代码中就引用这个字符串，在不同语言的语言文件就去定义这个字符串的值，展示在玩家面前的就是其对应语言的文字；如果这串文字没有在语言文件里面找到对应的值，就会原模原样的呈现在玩家面前
<ul>
<li>在找到的对应文字里面，会有一些比较奇怪的东西，比如说”%1$s”“%2$d”。如果大家学过C语言，可能会意识到，里面的&quot;$s&quot;指的是一个字符串，对应C语言的&quot;%s&quot;；&quot;$d&quot;是一个整数，即对应&quot;%d&quot;。的确（的猜测），这里的&quot;$&quot;之后跟的对应的就是C语言中“%”后面跟的。同理，也可以发现，里面“%”后面跟的数字就是上面的“LastOutputParams”列表的项数（这个项数不是从0开始数的！从1开始）。</li>
</ul>
</li>
<li>SuccessCount: (Integer) 该命令方块用红石比较器输出的模拟信号强度</li>
<li>CustomName: (String) 即命令方块界面中的“悬停说明”。当指针指向该命令方块时可以在方块上面看到它，也可以用在说话方面的指令上面，比如说&quot;say&quot;：默认没有写悬停说明的时候会在说话内容之前的中括号里面写上一个大大的感叹号，否则就会写上”悬停说明“里面对应的文字。【可以制造出有人在说话的效果，在RPG等剧情类的游戏中比较常用】</li>
<li>LPCommandMode: (Integer) 即命令方块界面中的“上一个输出”下面的”方块类型“。0是脉冲，1是重复，2是连锁。</li>
<li>LPCondionalMode: (Byte) 即命令方块界面中的“上一个输出”下面的”条件“。0是无条件，其它值都当作有条件。</li>
<li>LPRedstoneMode: (Byte) 即命令方块界面中的“上一个输出”下面的”红石“。0是始终活动，其它值都当作需要红石。</li>
</ul>
</li>
</ol>
<ul>
<li>TrackOutput: (Byte) 即命令方块界面中的“上一个输出”开关。0是关，此时LPCommandMode，LPCondionalMode，LPRedstoneMode这三个值的不存在不会造成游戏崩溃；其它值都是开，若这三个值的不存在，游戏会重置这三个值到默认的初始状态，即三个0。
<ul>
<li>powered: (Byte) 是否有在被充能。游戏在刷新区块时会刷新检测一个方块是否被充能，接下来再检测&quot;powered&quot;值是否为1，如果不为1，则执行这个命令方块，然后将&quot;powered&quot;值设置为1。</li>
</ul>
</li>
<li>Version: (Integer) 应该是命令方块在存档中存储的格式的版本号 方便游戏在下一次更新这个格式时判定是否需要将本地的格式升级，在1.16.40版本观测是”12“。</li>
</ul>
<blockquote>
<p><code>【开学后的第一个周末】</code></p>
</blockquote>
<p>​	例: 一个命令方块的界面与其在存档中的存储<br>
<img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/image-20200906093721967.png" alt="image-20200906093721967" loading="lazy"></p>
<ol start="20">
<li>
<p>末地折跃门</p>
<ul>
<li>id: (String) &quot;EndGateway”</li>
<li>isMovable: (Byte) 是否能被活塞推动，默认是1，即能推动。0是不能被推动。</li>
<li>ExitPortal: (List) 一个长度为3的整型数组，代表一个坐标，指向这个末地折跃门的传送坐标。</li>
<li>Age: (Integer) 这个传送门已经激活了多少个游戏刻。当这个值大于0且小于200时，折跃门会发出紫红色的信标光柱。当这个值超过Integer类型所能表示的最大数时，游戏仍然会将这个数自增，然后程序yuan们就知道会发生什么了。这个数会一直自增，只要玩家在刷新范围里面，这就是说，有生之年还可以看到一个末地折跃门在静默状态启动第二次，亮起第二次有点基的颜色光柱，想想就心动呀（个鬼）</li>
</ul>
</li>
<li>
<p>拼图方块</p>
<ul>
<li>id: (String) &quot;JigsawBlock”</li>
<li>isMovable: (Byte) 是否能被活塞推动，默认是1，即能推动。0是不能被推动。</li>
<li>name: (String) 即拼图方块界面中的“名称”</li>
<li>target: (String) 即拼图方块界面中的“目标名称”</li>
<li>target_pool: (String) 即拼图方块界面中的“目标池”</li>
<li>final_state: (String) 即拼图方块界面中的“变为”</li>
<li>joint: (String) 即拼图方块界面中的“接点类型”。rollable是”可滚动&quot;， aligned是“一致”。其它值都会被视作可滚动。</li>
</ul>
</li>
</ol>
<p>​	例: 一个拼图的界面与其在存档中的存储</p>
<figure data-type="image" tabindex="23"><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/image-20200906122022834.png" alt="image-20200906122022834" loading="lazy"></figure>
<ol start="22">
<li>
<p>结构方块</p>
<ul>
<li>
<p>id: (String) &quot;StructureBlock”</p>
</li>
<li>
<p>isMovable: (Byte) 是否能被活塞推动，默认是1，即能推动。0是不能被推动。</p>
</li>
<li>
<p>data: (Integer) 结构方块的模式。默认值是1，即保存。</p>
<table>
<thead>
<tr>
<th style="text-align:center"><strong>0</strong></th>
<th style="text-align:center"><img src="/post-images/bedrock-save/image-20200906125054673.png" width="50%"></img></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>1</strong></td>
<td style="text-align:center"><img src="/post-images/bedrock-save/image-20200906125141992.png" width="50%"></img></td>
</tr>
<tr>
<td style="text-align:center"><strong>2</strong></td>
<td style="text-align:center"><img src="/post-images/bedrock-save/image-20200906125531027.png" width="50%"></img></td>
</tr>
<tr>
<td style="text-align:center"><strong>3</strong></td>
<td style="text-align:center"><img src="/post-images/bedrock-save/image-20200906125647464.png" width="50%"></img></td>
</tr>
<tr>
<td style="text-align:center"><strong>4</strong></td>
<td style="text-align:center"><img src="/post-images/bedrock-save/image-20200906125838048.png" width="50%"></img></td>
</tr>
<tr>
<td style="text-align:center"><strong>5</strong></td>
<td style="text-align:center"><img src="/post-images/bedrock-save/image-20200906125921862.png" width="50%"></img></td>
</tr>
<tr>
<td style="text-align:center"><strong>其他值</strong></td>
<td style="text-align:center"><em>Boom~ 闪退~</em></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>dateField: (String) 默认值是空，好像没什么作用的样子</p>
</li>
<li>
<p>ignoreEntities: (Byte) 默认值是0，即忽略实体</p>
</li>
<li>
<p>ignorePlayers: (Byte) 默认值是0，忽略玩家？游戏中好像没有关于这个的设置</p>
</li>
<li>
<p>integrity: (Float) 默认值是100，即加载界面的完整性</p>
</li>
<li>
<p>isPowered: (Byte) 默认值是0，是否有在被红石充能（压力马斯内~ 即答）</p>
</li>
<li>
<p>mirror: (Byte) 默认值是0。这个值对应的是加载模式下面的镜像选项：</p>
<table>
<thead>
<tr>
<th>0</th>
<th><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/image-20200906135657425.png" alt="image-20200906135657425" loading="lazy"></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>1</strong></td>
<td><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/image-20200906131917608.png" alt="image-20200906131917608" loading="lazy"></td>
</tr>
<tr>
<td><strong>2</strong></td>
<td><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/image-20200906131754878.png" alt="image-20200906131754878" loading="lazy"></td>
</tr>
<tr>
<td><strong>3</strong></td>
<td><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/image-20200906132007371.png" alt="image-20200906132007371" loading="lazy"></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>redstoneSaveMode: (Integer) 默认值是0。保存至内存是0，保存至磁盘是1</p>
</li>
<li>
<p>removeBlocks: (Byte) 默认值是0，对应的是“移除方块”选项。关闭移除方块是0，开启移除方块是1</p>
</li>
<li>
<p>rotation: (Byte) 默认值是0，对应的是加载模式下的“旋转&quot;:</p>
<table>
<thead>
<tr>
<th style="text-align:center"><strong>0</strong></th>
<th style="text-align:center"><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/image-20200906141419224.png" alt="image-20200906141419224" loading="lazy"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>1</strong></td>
<td style="text-align:center"><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/image-20200906141536138.png" alt="image-20200906141536138" loading="lazy"></td>
</tr>
<tr>
<td style="text-align:center"><strong>2</strong></td>
<td style="text-align:center"><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/image-20200906141600228.png" alt="image-20200906141600228" loading="lazy"></td>
</tr>
<tr>
<td style="text-align:center"><strong>3</strong></td>
<td style="text-align:center"><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/image-20200906141615565.png" alt="image-20200906141615565" loading="lazy"></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>seed: (Long) 默认值是0，即加载界面的”种子&quot;文本框</p>
</li>
<li>
<p>showBoundingBox: (Byte) 默认值是1，即“显示边界盒”开关。1是开，0是关</p>
</li>
<li>
<p>structureName: (String) 默认值是空，即“建筑名称”文本框里的内容</p>
</li>
<li>
<p>xStructureOffset, yStructureOffset, zStructureOffset: (Integer) 三个数分别代表“偏移”标签下面的x，y，z。默认值是[ 0, -1, 0 ]</p>
</li>
<li>
<p>xStructureSize, yStructureSize, zStructureSize: (Integer) 三个数分别代表“保存”模式中“大小”标签下面的x，y，z。默认值是[ 0, -1, 0 ]</p>
</li>
</ul>
</li>
</ol>
<p>例: 一个结构方块的界面与其在存档中的存储</p>
<figure data-type="image" tabindex="24"><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/image-20200906153024656.png" alt="image-20200906153024656" loading="lazy"></figure>
<blockquote>
<p><code>【又该清空背包了，雪莉酱不假思索的在聊天列表里面打出了&quot;/cls&quot;】</code></p>
</blockquote>
<ol start="23">
<li>
<p>下界核心</p>
<p>虽然也是实体方块但是这个版本不知道怎么去获得，修改了之后由于游戏中下界反应核的功能代码被删掉了，修改就失去意义了，外置的Add-on应该也实现不了修改方块实体NBT，所以就直接跳过吧。</p>
</li>
<li>
<p>阳光传感器</p>
<ul>
<li>id: (String) &quot;DaylightDetector”</li>
<li>isMovable: (Byte) 是否能被活塞推动，默认是1，即能推动。0是不能被推动。<br>
【没错 就只有这么多/xk】</li>
</ul>
</li>
<li>
<p>花盆</p>
<ul>
<li>id: (String) &quot;FlowerPot”</li>
<li>isMovable: (Byte) 是否能被活塞推动，默认是1，即能推动。0是不能被推动。</li>
<li>PlantBlock: (Compound) 花盆里面放的花的方块NBT</li>
</ul>
</li>
<li>
<p>红石比较器</p>
<ul>
<li>id: (String) &quot;Comparator”</li>
<li>isMovable: (Byte) 是否能被活塞推动，默认是1，即能推动。0是不能被推动。</li>
<li>OutputSignal: (Integer) 该红石比较器输出的红石信号</li>
</ul>
</li>
<li>
<p>床🛏: 上半部分床和下半部分床分开存储</p>
<ul>
<li>id: (String) &quot;Bed”</li>
<li>isMovable: (Byte) 是否能被活塞推动，默认是1，即能推动。0是不能被推动。</li>
<li>color: (Byte) 床的颜色。如果两个床在方块实体中存储的颜色不相同，则取上半部分床为床的颜色。这个值所对应的颜色如下表：</li>
</ul>
</li>
</ol>
<img src="/post-images/bedrock-save/image-20200906155306927.png" alt="image-20200906155306927" width="20%" />
<ol start="28">
<li>
<p>炼药锅： 在方块实体，只存储炼药锅内的水的属性；水位在方块状态NBT里面存储</p>
<ul>
<li>id: (String) &quot;Cauldron”</li>
<li>isMovable: (Byte) 是否能被活塞推动。默认是1，即能推动；0是不能被推动。</li>
<li>Items: (List) 不清楚是干什么用的 [ ~- ^ -~ ]</li>
<li>CustomColor: (Integer) 当炼药锅里面是水，且已经被染色的时候，这个标签才存在。这个标签虽然看起来是一个Integer类型的整数，但是实际使用的时候是将这个整数拆分成四个字节，分别对应RGBA四个颜色数值。</li>
</ul>
<p>这是一个装满粉色染料染过色之后的水的炼药锅的CustomColor值:</p>
<figure data-type="image" tabindex="25"><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/image-20200906190921023.png" alt="image-20200906190921023" loading="lazy"></figure>
<ul>
<li>PotionType: (Short) 该药水的类型。0是普通药水，1是喷溅型药水，2是滞留性药水。如果炼药锅内装的不是药水，这里会写-1.</li>
<li>Potionid: (Short) 该药水的种类。如果炼药锅内装的不是药水，这里会是-1。其ta的药水对应如下表：</li>
</ul>
<figure data-type="image" tabindex="26"><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/image-20200906170138149.png" alt="image-20200906170138149" loading="lazy"></figure>
</li>
<li>
<p>潮涌核心</p>
<ul>
<li>id: (String) &quot;Conduit”</li>
<li>isMovable: (Byte) 是否能被活塞推动。默认是1，即能推动；0是不能被推动。</li>
<li>Active: (Byte) 该潮涌核心是否启动。0代表没启动，反之则1.</li>
<li>Target: (Long) 潮涌核心正在攻击的生物的uuid</li>
</ul>
</li>
<li>
<p>铃🔔 【维基上面说是跟铃的动画有关，但由于这个动画时间短，修改之后可能在游戏加载的时候铃的动画状态就还原了，所以,,,】</p>
<ul>
<li>id: (String) &quot;Bell”</li>
<li>isMovable: (Byte) 是否能被活塞推动。默认是1，即能推动；0是不能被推动。</li>
<li>Ringing: (Byte) 该铃声是否在响。1为是，0为非。</li>
<li>Ticks: (Integer) 从前一次敲击或放置这个铃开始数的游戏刻。</li>
<li>Direction: (Integer) 当铃静止不动时，这个值是255.</li>
</ul>
</li>
</ol>
<h3 id="子区块的数据">子区块的数据</h3>
<p>​	其实获取子区块不仅仅只是传一个“47”。因为在游戏中，子区块是从下到上堆积起来的，像堆积木一样。一个子区块的大小是16*16*16，所以我们需要在我们的“47”后面再接上一个byte类型（在下面就称这个数this_num辽）。这个byte类型的数字范围是[ 0, 15 ]【即0 &lt;= this_num&lt;= 15】，代表这个子区块是从最下面一个子区块向上数的第this_num个的子区块。所以这个子区块的y轴范围是[ this_num * 16, (this_num + 1) * 16 )【即 this_num * 16 &lt;= y轴范围 &lt; (this_num + 1) * 16】。</p>
<p>​	上面买了个小关子，这回我们终于拿到想要的地形存储了。再加上Python爬虫，爬取播放量多的midi文件并解析，最后再将红石音乐的样式生成做成一个Interface，唔，美汁汁~ 接下来，宁可能会被映入眼帘的获取到的杂乱的数据昏了头脑；用MCC ToolChest PE的读者，一定也会发现，在一个区块里面，似乎没有被提及的就是Sections这个列表了。这个列表里面又有几个子对象，宁可能会马上意识到，这就是我们这一节要调教的子区块，然后就会被迷住（😂）</p>
<p>​	我们先从MCC ToolChest开始讲起，因为ta有一个可视化的界面。没有装MCC ToolChest的同学也不要紧，我这里放上我的测试世界的某一个区块的MCC ToolChest界面：</p>
<figure data-type="image" tabindex="27"><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/UFD4W@Q8S%60NW%7DUOFDW%60ABKD.png" alt="img" loading="lazy"></figure>
<p>​	还有这个区块代表的区块截图：</p>
<figure data-type="image" tabindex="28"><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/image-20200906201146132.png" alt="image-20200906201146132" loading="lazy"></figure>
<p>​	将所有的标签都展开，我们就可以发现，这个子区块中的Palette存储的是这个子区块所有类型方块的方块NBT。那么为什么要这样存呢？脑袋转的快的同学马上就能反应出来，游戏为了压缩世界大小，将所有类型的方块状态存在一个列表里面，那么存储方块就是存储这个方块在列表里面的索引。存储的少，算法还简单，读写就更快了，两全其美。然后下面的BlockStates就是这个子区块的每一个方块对应的索引。</p>
<p>​	这就是我们的假说，接下来我们要做的就是将上面的BlockStates导出，变成一张表，然后将这张表对着Palette中的项去对照。我们就取有熔炉的那一层，是第58层，即这个子区块的第<code>58 % 16 = 10</code>层。按照每一层<code>16 * 16 = 256</code>个方块，每个方块的索引占一个Integer即4个字节，我们就得取偏移了<code>(10 - 1) * (256 * 4) = 9216</code>字节之后的1024字节：</p>
<table>
<thead>
<tr>
<th style="text-align:center"><strong>0</strong></th>
<th style="text-align:center"><strong>0</strong></th>
<th style="text-align:center"><strong>0</strong></th>
<th style="text-align:center"><strong>0</strong></th>
<th style="text-align:center"><strong>0</strong></th>
<th style="text-align:center"><strong>0</strong></th>
<th style="text-align:center"><strong>0</strong></th>
<th style="text-align:center"><strong>0</strong></th>
<th style="text-align:center"><strong>0</strong></th>
<th style="text-align:center"><strong>0</strong></th>
<th style="text-align:center"><strong>0</strong></th>
<th style="text-align:center"><strong>0</strong></th>
<th style="text-align:center"><strong>0</strong></th>
<th style="text-align:center"><strong>0</strong></th>
<th style="text-align:center"><strong>0</strong></th>
<th style="text-align:center"><strong>0</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>5</strong></td>
<td style="text-align:center"><strong>2</strong></td>
<td style="text-align:center"><strong>2</strong></td>
<td style="text-align:center"><strong>2</strong></td>
<td style="text-align:center"><strong>5</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>2</strong></td>
<td style="text-align:center"><strong>12</strong></td>
<td style="text-align:center"><strong>10</strong></td>
<td style="text-align:center"><strong>11</strong></td>
<td style="text-align:center"><strong>2</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>2</strong></td>
<td style="text-align:center"><strong>14</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>6</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>2</strong></td>
<td style="text-align:center"><strong>15</strong></td>
<td style="text-align:center"><strong>15</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>2</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>5</strong></td>
<td style="text-align:center"><strong>2</strong></td>
<td style="text-align:center"><strong>2</strong></td>
<td style="text-align:center"><strong>2</strong></td>
<td style="text-align:center"><strong>5</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
</tr>
<tr>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
<td style="text-align:center"><strong>0</strong></td>
</tr>
</tbody>
</table>
<p>​	不难将其根据Palette转换成图：【由于这里看不出来床的颜色 所以默认使用白色】</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"><img src="https://static.wikia.nocookie.net/minecraft_gamepedia/images/c/c5/Oak_Log_Axis_Y_JE5_BE3.png/revision/latest/scale-to-width-down/300?cb=20200317191605" width="70%"></img></td>
<td style="text-align:center"><img src="https://static.wikia.nocookie.net/minecraft_gamepedia/images/3/37/Oak_Planks_JE6_BE3.png/revision/latest/scale-to-width-down/300?cb=20200317041641" width="70%"></img></td>
<td style="text-align:center"><strong><img src="https://static.wikia.nocookie.net/minecraft_gamepedia/images/3/37/Oak_Planks_JE6_BE3.png/revision/latest/scale-to-width-down/300?cb=20200317041641" width="70%"></img></strong></td>
<td style="text-align:center"><strong><img src="https://static.wikia.nocookie.net/minecraft_gamepedia/images/3/37/Oak_Planks_JE6_BE3.png/revision/latest/scale-to-width-down/300?cb=20200317041641" width="70%"></img></strong></td>
<td style="text-align:center"><img src="https://static.wikia.nocookie.net/minecraft_gamepedia/images/c/c5/Oak_Log_Axis_Y_JE5_BE3.png/revision/latest/scale-to-width-down/300?cb=20200317191605" width="70%"></img></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"><img src="https://static.wikia.nocookie.net/minecraft_gamepedia/images/3/37/Oak_Planks_JE6_BE3.png/revision/latest/scale-to-width-down/300?cb=20200317041641" width="70%"></img></td>
<td style="text-align:center"><img src="https://static.wikia.nocookie.net/minecraft_gamepedia/images/0/07/Crafting_Table_JE4.png/revision/latest/scale-to-width-down/300?cb=20191229083529" width="70%"></img></td>
<td style="text-align:center"><img src="https://static.wikia.nocookie.net/minecraft_gamepedia/images/1/1a/White_Bed_JE3_BE3.png/revision/latest/scale-to-width-down/150?cb=20200317231837" width="70%"></img><font size="2px">【床尾】</font></td>
<td style="text-align:center"><strong><img src="https://static.wikia.nocookie.net/minecraft_gamepedia/images/1/1a/White_Bed_JE3_BE3.png/revision/latest/scale-to-width-down/150?cb=20200317231837" width="70%"></img></strong><font size="2px">【床头】</font></td>
<td style="text-align:center"><strong><img src="https://static.wikia.nocookie.net/minecraft_gamepedia/images/3/37/Oak_Planks_JE6_BE3.png/revision/latest/scale-to-width-down/300?cb=20200317041641" width="70%"></img></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"><strong><img src="https://static.wikia.nocookie.net/minecraft_gamepedia/images/3/37/Oak_Planks_JE6_BE3.png/revision/latest/scale-to-width-down/300?cb=20200317041641" width="70%"></img></strong></td>
<td style="text-align:center"><img src="https://static.wikia.nocookie.net/minecraft_gamepedia/images/4/49/Furnace_JE3_BE2.png/revision/latest/scale-to-width-down/300?cb=20200902213128" width="70%"></img></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"><img src="https://static.wikia.nocookie.net/minecraft_gamepedia/images/7/70/Oak_Door_JE5_BE2.png/revision/latest/scale-to-width-down/300?cb=20200317191541" width="70%"></img></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"><strong><img src="https://static.wikia.nocookie.net/minecraft_gamepedia/images/3/37/Oak_Planks_JE6_BE3.png/revision/latest/scale-to-width-down/300?cb=20200317041641" width="70%"></img></strong></td>
<td style="text-align:center"><img src="https://static.wikia.nocookie.net/minecraft_gamepedia/images/4/41/Chest.gif/revision/latest/scale-to-width-down/300?cb=20191219163202" width="70%"></img></td>
<td style="text-align:center"><strong><img src="https://static.wikia.nocookie.net/minecraft_gamepedia/images/4/41/Chest.gif/revision/latest/scale-to-width-down/300?cb=20191219163202" width="70%"></img></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"><strong><img src="https://static.wikia.nocookie.net/minecraft_gamepedia/images/3/37/Oak_Planks_JE6_BE3.png/revision/latest/scale-to-width-down/300?cb=20200317041641" width="70%"></img></strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"><img src="https://static.wikia.nocookie.net/minecraft_gamepedia/images/c/c5/Oak_Log_Axis_Y_JE5_BE3.png/revision/latest/scale-to-width-down/300?cb=20200317191605" width="70%"></img></td>
<td style="text-align:center"><strong><img src="https://static.wikia.nocookie.net/minecraft_gamepedia/images/3/37/Oak_Planks_JE6_BE3.png/revision/latest/scale-to-width-down/300?cb=20200317041641" width="70%"></img></strong></td>
<td style="text-align:center"><img src="https://static.wikia.nocookie.net/minecraft_gamepedia/images/3/37/Oak_Planks_JE6_BE3.png/revision/latest/scale-to-width-down/300?cb=20200317041641" width="70%"></img></td>
<td style="text-align:center"><img src="https://static.wikia.nocookie.net/minecraft_gamepedia/images/3/37/Oak_Planks_JE6_BE3.png/revision/latest/scale-to-width-down/300?cb=20200317041641" width="70%"></img></td>
<td style="text-align:center"><img src="https://static.wikia.nocookie.net/minecraft_gamepedia/images/c/c5/Oak_Log_Axis_Y_JE5_BE3.png/revision/latest/scale-to-width-down/300?cb=20200317191605" width="70%"></img></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<p>​	接下来与原版进行对比:</p>
<figure data-type="image" tabindex="29"><img src="https://lovelyzeeiam.github.io/post-images/bedrock-save/image-20200906213556482.png" alt="image-20200906213556482" loading="lazy"></figure>
<p>​	因为盔甲架是实体，不算方块，所以就可以看到，算是完全一致。那么这个假说算是可以证明成立了。【大家可以替换掉几个方块，多实验几次，毕竟只实验一次具有偶然性，这里为了节省篇幅就不多做实验了】</p>
<p>​	所以我们可以得出初步的结论：在存档里面，游戏将所有类型的方块状态存在一个列表里面，存储方块就是存储这个方块在这个列表里面的索引。懂得了这个原理，我们就可以从图形的界面进入二进制的世界了~ 啊好，没进呢。我们先整理一下游戏存储了些什么：首先就是上面提到的索引，然后就是列表，可能还会存个版本号。列表需要什么呢？需要一个数字代表这个列表存了多少个方块状态。OK，接下来我们就来康康在磁盘中，这些数据该怎么存储。</p>
<p>​	正如我们所猜测的一样，在磁盘中，这些数据的存储分为三个部分：标头，索引区，数据区：</p>
<ul>
<li>
<p>标头只占二字节，第一个字节是版本号，在1.16.40版本中这个版本号是8；第二个字节表示这个地方存储了几层方块，在包含含水方块的子区块，这个数会有变化，下面会有说明。</p>
</li>
<li>
<p>数据区就是存储方块的索引和方块状态NBT的区域。这一部分有许多层，取决于标头的第二个字节。每一层之间是紧密连接的。</p>
<p>每一层的第一个字节向右移一位得到的结果是最大的索引值的有效数据区占用多少字节，为了方便提及令变量x。什么叫有效数据区呢？我们随便说一个十进制的数字：192837465；将这个数字以Long形式存储到磁盘里面会是：<code>0000 0000 0000 0000 0000 1011 0111 1110 0111 0111 0101 1001</code> 。在这串字节里面，真正有意义的只有四个字节（即28个bit）: <code>1011 0111 1110 0111 0111 0101 1001</code> ，其ta字节是纯属混进来凑数的，所以这个数字的有效数据区就占28个bit。</p>
<p>然后的部分存储的单位是一个Integer类型。这一个区域是这一层的索引区。就是说游戏每次会读取一个Integer，然后将其转换为二进制，根据上面计算出来的x从高字节位的第一位开始分割这32位，舍弃分剩的位，得到方块索引。举个例子：当x = 5，游戏读取到了十进制数<code>34603008</code>，然后将其转换为二进制<code>00000010 00010000 00000000 00000000</code> ，然后重新分割成<code>00|00001|00001|00000|00000|00000|00000|</code>得到六个索引：1，1，0，0，0，0。首先游戏会先存y轴的方块，再沿着z轴存储，再沿着x轴存储；就是说，如果游戏读到了第<code>position</code>个方块索引，那么这个方块索引所对应的x, y, z坐标就是：</p>
<pre><code class="language-java">    int x = (position &gt;&gt; 8) &amp; 0xF;
    int y = position &amp; 0xF;
    int z = (position &gt;&gt; 4) &amp; 0xF;
</code></pre>
<p>【以后就能够在朋友面前装_啦...咳咳我在说什么】</p>
<p>上面的索引存完之后，就会进入这一层的数据区。这个区域以一个数开头，代表这里面存储了多少的方块状态NBT。每个方块状态NBT以一个Compount Tag存储。可以将这一部分当作一个列表，那么上面的索引区就是用数组下标来访问这个列表的（列表的第一个元素的索引是0）。</p>
</li>
</ul>
<p>​	于是有的同学就会问了：<code>雪莉雪莉，如果一个Integer装不下一个方块索引该怎么办呢？</code> 首先吖，一个Integer的最大值大于一千万，而目前游戏中不同的方块状态的种类数量加起来都不到一万（猜测）。所以目前大可不必关心这。</p>
<p>​	个人感觉自己的表达能力不是很好，那么下面我们就来具体分析几个例子，帮助同学们理解。</p>
<img src="/post-images/bedrock-save/image-20200910223012101.png" alt="image-20200910223012101" />
<p>​	这是从我的“焦糖星”红石音乐那个世界的一个区块的某个子区块的数据。大家可以综合上面的知识来分析一下在索引区的第一个Integer类型对应的是哪些（或哪个）索引。大家可以思考几分钟，在下面就展示答案与解析（必刷题？？）</p>
<p>​	解析： 首先我们来看第三个字节，对应的数是10，将这个数向右移位一位，得到的数是5，我们不妨将其设为x【下面要提到】。接下来我们看索引区的第一个Integer类型，将其转换为二进制即<code>00101101 01101000 00000100 00100000</code>。因为上面的x是5，就代表我们要将这些二进制从高字节位的第一位开始分割，每五位分割一次，就得到了<code>00|10110|10110|10000|00001|00001|00000|</code>，然后我们将其变成六个数，即：22，22，16，1，1，0。【感谢MCC ToolChest PE让我非常非常方便的验证了结果是正确哒~】</p>
<p>​	根据上面的解析过程，大家肯定会想到一个问题，这些索引都是哪一个地方的方块的索引呢？我就来解答啦。游戏在读取一个子区块的时候，首先会先读取数据区，得到所有的元素，存储为一个列表，我们就姑且叫ta数据列表吧。游戏读到了这六个索引之后会将这六个索引从后向前转进一个列表（列表的第一个元素是上面得到的六个索引的最后一个）。然后会新建一个变量a，代表读到的是第几个索引，然后用上面的x, y, z坐标计算公式来计算。由于这些索引的来源是索引区的第一个Integer类型，所以此时a的值是其初始值0。然后游戏会循环上面的列表，每得到一个元素就将此时的a的值转换成x, y ,z坐标，然后将其对应的这个子区块的方块的方块状态根据索引的值设置成其在数据列表中对应的元素，然后将a自增1。伪代码:</p>
<pre><code class="language-java">	int position = 0;
	// 这个子区块的所有方块的方块对象
	Block[][][] blockGrid = new Block[16][16][16];

	for(还没穷尽索引区) {
        ...
        // ... 得到索引列表，变量名为&quot;indices&quot;
        
        for(int a = 0; a &lt; indices.length; a++) {
            int index = indices[i];
            
            // 得到坐标
            int x = (position &gt;&gt; 8) &amp; 0xF;
            int y = position &amp; 0xF;
            int z = (position &gt;&gt; 4) &amp; 0xF;
            
            // 得到方块状态
        	CompoundTag tag = datas.get(index);
            
            // 创建新的方块对象，传入方块状态这个参数
            // new Block(CompoundTag block_state_nbt)
            Block block = new Block(tag);
            blockGrid[x][y][z] = block;
            
            position++;
            
        }
        
    }
</code></pre>
<blockquote>
<p><code>明天又是星期六~ 开森</code></p>
</blockquote>
<p>​	如何写入的答案就是上面那个解析过程的逆过程。我的猜测是游戏先写入标头的第一个字节（版本号），然后再新建一个列表和一个三维数组，将子区块内的所有方块循环一遍。循环的时候就判断列表中是否已经存在与这个方块相同的方块状态NBT，如果已经存在，那么就获取这个方块状态NBT对应的已经存储在的列表内的索引，否则就将这个方块状态NBT加入到这个列表里面，然后再获取这个方块状态NBT对应的已经存储在的列表内的索引。得到了所有方块的方块状态NBT和方块索引的三维数组之后，再去计算标头的第二个字节和第三个字节。</p>
<p>​	一次意外的想法——含水方块——让我发现了第二个字节的秘密（Neh heh heh)。原来“山重水复疑无路，柳暗花明又一村”就是这个道理吖~</p>
<h3 id="结构-2">结构</h3>
<p>​	上面在”存档其它信息“里面提及了如何获取一个结构的数据，这里就不再赘述了，还没有看的同学可以去康康。</p>
<p>​	获取到的数据应该是一个NBT数据，并且是由一个Compound Tag包裹的NBT数据。在这个父Compound Tag会存在这些数据：</p>
<table border=0 cellpadding=0 cellspacing=0>
 <col>
 <col>
 <tr>
  <td>键</span></td>
  <td>
  <span style='font-variant-ligatures: normal;font-variant-caps: normal;
  orphans: 2;white-space:pre-wrap;widows: 2;-webkit-text-stroke-width: 0px;
  text-decoration-style: initial;text-decoration-color: initial'>说明</span></td>
 </tr>
 <tr>
  <td>format_version</td>
  <td>这里存储的是一个Integer类型的数，代表该结构方块的格式版本，在基岩版1.16.40版本这个值是1.</td>
 </tr>
 <tr>
  <td>
  <span style='font-variant-ligatures: normal;font-variant-caps: normal;
  orphans: 2;white-space:pre-wrap;widows: 2;-webkit-text-stroke-width: 0px;
  text-decoration-style: initial;text-decoration-color: initial'>size</span></td>
  <td>这里存储的是一个长度为3的Integer列表，代表这个结构的大小。</td>
 </tr>
 <tr>
  <td>
  <span style='font-variant-ligatures: normal;font-variant-caps: normal;
  orphans: 2;white-space:pre-wrap;widows: 2;-webkit-text-stroke-width: 0px;
  text-decoration-style: initial;text-decoration-color: initial'>structure_world_origin</span></td>
  <td class=xl66 width=546 style='width:410pt'>这里存储的是一个长度为3的Integer的列表，代表这个结构在世界中的坐标。这个坐标是该结构起始的地方，一般是这个结构中所能表示的最小的坐标。</td>
 </tr>
 <tr height=38 style='height:28.5pt'>
  <td height=38 class=xl66 width=163 style='height:28.5pt;width:122pt'>structure</td>
  <td class=xl66 width=546 style='width:410pt'>这里存储的是一个Compound
  Tag，是该结构的数据存储的地方。在这个Compound Tag里面会存储下列的数据：<br/>
  	<table border=0 cellpadding=0 cellspacing=0>
        <td>键</td>  <td>类型</td>  <td>值</td> </tr> <tr>  <td>palette</td>  <td>Compound</td>  <td>这里存储的是所有方块的样式，跟上面存储方块状态NBT一样的存储方式</td> </tr> <tr>  <td>entities</td>  <td>List</td>  <td>这里存储的是该结构内的所有实体，里面存储的是实体Compound  Tag。该实体的坐标似乎没有找到规律，大家可以亲手去试试。</td> </tr> <tr>  <td>block_position_data</td>  <td>Compound</td>  <td>目前暂时不清楚</td> </tr> <tr>  <td>block_indices</td>  <td>List</td>  <td>有了上面的索引知识，这里就很好解释了。这里存储的是方块索引组成的列表，存储方式跟上面的索引是一样的。如果这个区块在存储时存在多层的情况，那么这里也会有多层。其中第一层一般是记录所有第一眼可见的方块，第二层一般是记录含水方块的水（大概），如果第二层是空气，那么游戏会记录一个-1，而不是第一层一样记录一个空气。</td> </tr>
	</table>
  </td>
 </tr>
 <![if supportMisalignedColumns]>
 <tr height=0 style='display:none'>
  <td width=163 style='width:122pt'></td>
  <td width=546 style='width:410pt'></td>
 </tr>
 <![endif]>
</table>
<h1 id="一些有用的东东">一些有用的东东</h1>
<p>​	上面讲了这么多的关于理论的（枯燥）的东东，这回我们终于要开始动手搞事情了。理论的东西毕竟最终还是枯燥乏味的，就像如果只学物理但不去亲自动手做实验，只学习编程的知识却不动手敲代码一样。更多的东西与不全的东西毕竟还是得大家寻找，毕竟一个bug（特性）的发现不仅靠观看源码，还靠一定程度上的推测和实验中的偶然。</p>
<p>​	一定程度上的帮助也是很必要的，即”君子性非异也，善假于物也“【君子的资质跟一般人没什么不同，只是善于借助外物罢了】（”性“原写作”生“，是个通假字）。所以在这里也提供一些可供查找的资料。</p>
<h3 id="nbt格式">NBT格式</h3>
<p>​	上面讲过的NBT格式只是一个概述，有可能存在没有概括全或者有错误的地方，可以去到：<a href="https://minecraft.gamepedia.com/NBT_format" title="NBT格式">NBT格式</a></p>
<h3 id="方块状态nbt">方块状态NBT</h3>
<p>​	可以去到:  <a href="https://minecraft.gamepedia.com/Block_states" title="方块状态NBT">方块状态NBT</a>。这里就介绍一下如何去阅读这个页面。</p>
<p>​	首先在里面找到想要查看的方块，向下划到对应的位置，会有一个表格；表格上面会有该方块对应的维基界面。点去这个方块的维基界面之后向下划到”数据值（Data values），到下面找到基岩版的命名空间ID（Namespaced ID）。接下来要做的事就是在自己的脑海中创建一个NBT格式的Compound Tag，首先向里面加入一个名字叫&quot;name&quot;的字符串标签，值为上面的命名空间ID；然后再向里面加入一个Integer类型的标签叫&quot;version&quot;，在基岩版1.16.40中，这个值为17825808；接着再加入一个Compound Tag名字叫&quot;states&quot;，接下来要做的就是将表格中的每一行的数据都加入到这个表格中来：Name列对应标签的名称；标签的类型要根据&quot;Allowed values&quot;这一列的数据判断：如果只存在&quot;true&quot;和&quot;false&quot;两种情况，那么就是一个类型为Byte的标签，其中false对应的值为0，true为1；如果只存在数字的情况，那么大多数都应该是Integer类型的；如果存在的都是字符串，那么久都是字符串类型的。加入了所有的列之后，就可以将其放入子区块中的方块状态NBT列表中惹~ 这里就拿炼药锅做例子，写一段上述过程的伪代码，伪代码上面是炼药锅的方块状态NBT在维基上面的截图：</p>
<img src="/post-images/bedrock-save/image-20200912230515894.png" alt="image-20200912230515894" />
<pre><code class="language-java">	// 创建一个复合标签
	CompoundTag tag = new CompoundTag();
	
	// 命名空间 如果不是外置Add-ons就得加入&quot;minecraft:&quot;前缀代表命名空间
	tag.put(new StringTag(&quot;name&quot;, &quot;minecraft:cauldron&quot;));
	// 格式版本
	tag.put(new IntTag(&quot;version&quot;, 17825808));
	
	{
        //又一个复合标签
        CompoundTag stateTag = new CompoundTag(&quot;states&quot;);
        
        // fill_level
        stateTag.put(new IntTag(&quot;fill_level&quot;, 6));
        // cauldron_liquid
        stateTag.put(new StringTag(&quot;cauldron_liquid&quot;, &quot;water&quot;));
     
        // 将states加入进去
        tag.put(stateTag);
    }

	// 将这个复合标签加入到数据区中的方块状态列表并返回对应索引的值
	// 假装有这样的方法: int add(Object) 如果列表中存在同样的元素，就返回那个元素的索引; 否则就先在这个列表的结尾加入这个元素，然后返回目前列表的元素数量 - 1【Do you know why~】
	int index = datas.add(tag);
	
</code></pre>

                </div>
            </article>
        </div>

        

        

        

        

        <div class="site-footer gt-c-content-color-first">
    <div class="slogan gt-c-content-color-first"></div>
    <div class="social-container">
        
            
        
            
        
            
        
            
        
            
        
            
        
    </div>
    <div class="footer-info">
        
    </div>
    <div>
        Theme by <a href="https://imhanjie.com/" target="_blank">imhanjie</a>, Powered by <a
                href="https://github.com/getgridea/gridea" target="_blank">Gridea | <a href="https://lovelyzeeiam.github.io/atom.xml" target="_blank">RSS</a></a>
    </div>
</div>

<script>
  hljs.initHighlightingOnLoad()
</script>

    </div>
</div>
</body>
</html>
